/*
 * This file is automatically generated by CLIDE
 */


// From module_interface.c
	.extern _M70_CC_MCV
	.extern _M70_CC_PCT
	.extern _M70_CC_MALLOC_PTR
	.extern _M70_CC_MALLOCED


// Subkernel interface 
	.extern X_M_S_SUBKERNEL_POSTMALLOC
	.extern X_M_S_SUBKERNEL_POSTKICKSTART
	.extern X_M_S_SUBKERNEL_BRICK
	.extern X_M_S_SUBKERNEL_FRAME
	.extern X_M_S_SUBKERNEL_PREMALLOC
	.extern X_M_S_SUBKERNEL_BG
	.extern X_VX_CC_SAMPLE_RATE
	.extern X_VX_CC_BLOCK_COUNT
    .extern X_VX_CC_HEADROOM_ENABLED

// Routines 
	.public _M70_CC_postKickstart
	.public _M70_CC_frame
	.public _M70_CC_brick
	.public _M70_CC_background
	.public _M70_CC_preMallocInit
	.public _M70_CC_postMallocInit

X_M70_CC_my_brick_count .xdata_ovly
I_VX_MY_BRICK_COUNT .dw 0                       # brick count maintained by THIS module

CODE_M70_CC .code_ovly

_M70_CC_frame:
	x0 = xmem[X_VX_CC_SAMPLE_RATE]
	ymem[_M70_CC_MCV] = x0              # update mcv[0] with current sample rate
	i0 = (_M70_CC_PCT)
	i1 = (_M70_CC_MALLOCED)
	jmp X_M_S_SUBKERNEL_FRAME

_M70_CC_brick:
	a0 = xmem[I_VX_MY_BRICK_COUNT]
	uhalfword(a1) = (0x1)
	a0 = a0 + a1;	nm0 = a1                    # increment local brick counter
	xmem[I_VX_MY_BRICK_COUNT] = a0h
	i0 = (_M70_CC_PCT)
	i1 = (_M70_CC_MALLOCED)
	jmp  X_M_S_SUBKERNEL_BRICK


_M70_CC_background:
	i0 = (_M70_CC_PCT)
	i1 = (_M70_CC_MALLOCED)
	jmp X_M_S_SUBKERNEL_BG

_M70_CC_postKickstart:
    uhalfword(x0) = (1)
    xmem[X_VX_CC_HEADROOM_ENABLED]=x0    
	i0 = (_M70_CC_PCT)
	i1 = (_M70_CC_MALLOCED)
	i2 = (_M70_CC_MALLOC_PTR)
	jmp X_M_S_SUBKERNEL_POSTKICKSTART

_M70_CC_preMallocInit: 
	i1 = (_M70_CC_MALLOCED)
	i2 = (_M70_CC_MALLOC_PTR)
	jmp X_M_S_SUBKERNEL_PREMALLOC

_M70_CC_postMallocInit:
	i0 = (_M70_CC_PCT)
	i1 = (_M70_CC_MALLOCED)
	i2 = (_M70_CC_MALLOC_PTR)
	jmp X_M_S_SUBKERNEL_POSTMALLOC

